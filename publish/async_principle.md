# **ğŸ’¡ ë¹„ë™ê¸°ì™€ í”„ë¡œë¯¸ìŠ¤**

"ë™ê¸°ë‹¤, ë¹„ë™ê¸°ë‹¤", ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ë©´ì„œ ë§ì´ ë“¤ì–´ì˜¨ ë§ì´ë‹¤. ë¹„ë™ê¸°ì™€ í”„ë¡œë¯¸ìŠ¤ë¥¼ ì´í•´í•œë‹¤ëŠ” ê²ƒì€ í”„ë¡œê·¸ë¨ì˜ íë¦„ì„ ì´í•´í•˜ê³  ì„±ëŠ¥ ìµœì í™”, ì—ëŸ¬ í•¸ë“¤ë§ ë“±ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ì•„ì£¼ ì¤‘ìš”í•œ ìš”ì†Œì´ê¸° ë•Œë¬¸ì— ì •ë¦¬í•´ ë³´ê³ ì í•œë‹¤.

`ë¨¼ì € ë™ê¸°ì™€ ë¹„ë™ê¸°ë€ ë­˜ê¹Œ?`

## **ğŸ“‚ë™ê¸°ì™€ ë¹„ë™ê¸°**

ì™¼ìª½ ê·¸ë¦¼ì„ ì‚´í´ë³´ë©´, ë™ê¸°ì ì¸ ê³¼ì •ì€ **í•˜ë‚˜ì˜ ì¼ì´ ëë‚  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¸ë‹¤ê°€** ë‹¤ìŒ ì¼ì„ ì²˜ë¦¬í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•˜ê³ , ì˜¤ë¥¸ìª½ ê·¸ë¦¼ì˜ ë¹„ë™ê¸° ê³¼ì •ìœ¼ë¡œ **í•˜ë‚˜ì˜ ì¼ì„ ëë‚  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì¼ì„ ë™ì‹œ**ì— ì²˜ë¦¬í•˜ê³  ìˆë‹¤. ë¹„ë™ê¸° ì²˜ë¦¬ ê³¼ì •ì€ ì—¬ëŸ¬ ì¼ì„ ê°™ì´ í•˜ê³  ìˆê¸° ë•Œë¬¸ì— í›¨ì”¬ ì‹œê°„ì´ ì ê²Œ ê±¸ë¦¬ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.

ì´ë ‡ê²Œ í•˜ë‚˜ì˜ ì¼ì„ ì²˜ë¦¬í•˜ëŠ”ë° ì˜¤ëœ ì‹œê°„ì´ ê±¸ë ¤ ì´í›„ ì‘ì—…ì„ ë§‰ê²Œ ë˜ëŠ” ê²½ìš°, ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ í†µí•´ íš¨ìœ¨ì„ ë†’ì¼ ìˆ˜ ìˆë‹¤.

![https://poiemaweb.com/img/synchronous.png](https://poiemaweb.com/img/synchronous.png)

![https://poiemaweb.com/img/asynchronous.png](https://poiemaweb.com/img/asynchronous.png)

a,b,c ë¼ëŠ” ë³€ìˆ˜ë¥¼ ê°„ë‹¨í•˜ê²Œ í˜¸ì¶œí•˜ê³  ìˆëŠ” ì˜ˆì‹œë¥¼ ë³´ì.

```
const a = 1;
const b = 2;
const c = 3;

console.log(a);
console.log(b);
console.log(c);

//ê²°ê³¼: 1,2,3

//ë¹„ë™ê¸°
console.log(a);
setTimeout(() => {
 Â console.log(b);
}, 0);
console.log(c);

//ê²°ê³¼: 1,3,2

```

ë™ê¸° ì½”ë“œì¸ ìœ„ì˜ ì˜ˆì‹œëŠ” ê²°ê³¼ê°€ ì¼ì˜ ìˆœì„œëŒ€ë¡œ 1,2,3ì´ë€ ê²°ê³¼ë¥¼ ë‚˜íƒ€ë‚´ê³ , ë¹„ë™ê¸° ì½”ë“œì¸ ì•„ë˜ì˜ ì˜ˆì‹œëŠ” 1,3,2ë¼ëŠ” ì½”ë“œë¥¼ ì ì€ ìˆœì„œì™€ ë‹¤ë¥¸ ê²°ê³¼ë¥¼ ê°–ê²Œ ë˜ì—ˆë‹¤.

console.log(b)ë¥¼ console.log(c)ë³´ë‹¤ ë¨¼ì € ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì´ ì½ì—ˆì§€ë§Œ, ë¹„ë™ê¸° ì²˜ë¦¬ì— ì˜í•´ ìˆœì„œëŒ€ë¡œ ì§„í–‰í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ bë¥¼ ë‹¤ë¥¸ ê³³ì—ì„œ ì²˜ë¦¬í•œ í›„ì— ê°€ì ¸ì˜¤ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì¸ë‹¤. ë§Œì•½ bê°€ ì²˜ë¦¬í•˜ëŠ”ë° ì—„ì²­ ì˜¤ë˜ ê±¸ë¦¬ëŠ” ê³¼ì •ì´ë¼ê³  ê°€ì •í•œë‹¤ë©´, ë™ê¸°ì  ì½”ë“œì—ì„œëŠ” ì˜¤ëœ ì‹œê°„ ë’¤ì— cê°€ í˜¸ì¶œì´ ê°€ëŠ¥í•˜ë‹¤. ë¹„ë™ê¸° ì²˜ë¦¬ë¡œ ì¸í•´ ì˜¤ë˜ ê±¸ë¦¬ëŠ” bë¼ëŠ” ì¼ì„ ë„˜ê²¨ì„œ ì²˜ë¦¬í•˜ëŠ” ë™ì•ˆ cë¥¼ ì²˜ë¦¬í•˜ë©´ í›¨ì”¬ íš¨ìœ¨ì ìœ¼ë¡œ ì¼ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.

ê·¸ëŸ¬ë©´ ì´ë ‡ê²Œ ë³´ë‚´ì§„ ë¹„ë™ê¸° ì²˜ë¦¬ëŠ” ì–´ë””ì„œ, ì–´ë–»ê²Œ ì´ë£¨ì–´ì§€ëŠ” ê±¸ê¹Œ?

## **â° ëª¨ë“  ì¼ì˜ ìˆœì„œë¥¼ ê´€ë¦¬í•˜ëŠ” ìŠ¤ì¼€ì¤„ëŸ¬, Event loop**

ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” **ì‹±ê¸€ ìŠ¤ë ˆë“œ**ë¡œ ì¼ì´ ì²˜ë¦¬ëœë‹¤.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/32ef10df-0e33-4451-910a-5ae84222d944/Untitled.png)

ì‹±ê¸€ ìŠ¤ë ˆë“œë¼ëŠ” ê²ƒì€ ìœ„ì˜ ì‚¬ì§„ê³¼ ê°™ì´ ì½œìŠ¤í…ì´ í•˜ë‚˜ë¼ëŠ” ê²ƒ!! ì¦‰ í•œê³³ì—ì„œ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ê³  ì¢…ë£Œí•˜ëŠ” ê³¼ì •ì„ ë°˜ë³µ!! ì—¬ëŸ¬ ê°œì˜ ì¼ì„ í•œë²ˆì— ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, **í•œë²ˆì˜ í•˜ë‚˜ì˜ ì¼ë§Œ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤**ëŠ” ì˜ë¯¸ë‹¤. ê·¸ëŸ¬ë©´ ì•ì„œ ë³´ì•˜ë˜ ë¹„ë™ê¸° ì²˜ë¦¬ëŠ” ì–´ë””ì„œ ì´ë£¨ì–´ì§€ëŠ” ì˜ë¬¸ì´ ë“ ë‹¤. ë¹„ë™ê¸°ëŠ” ì—¬ëŸ¬ ê°œì˜ ì¼ì„ ë™ì‹œì— ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ê³ , ìš°ë¦¬ê°€ ë¸Œë¼ìš°ì €ë¥¼ ì´ìš©í•  ë•Œ ì—¬ëŸ¬ ê°œì˜ ì¼ì„ ë™ì‹œì— í•˜ëŠ” ê²ƒì²˜ëŸ¼ ëŠê»´ì§€ëŠ”ë° ì–´ë–»ê²Œ ëœ ê±¸ê¹Œ?

ì´ê²ƒì„ ì´í•´í•˜ê¸° ìœ„í•´ì„œëŠ” ë¨¼ì € **ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ê³¼ ë¸Œë¼ìš°ì €ì˜ ì—­í• **ì„ ì´í•´í•  í•„ìš”ê°€ ìˆë‹¤.

ë¨¼ì € ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì—ëŠ” **í™ê³¼ ì½œìŠ¤íƒ**ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤. ì½œìŠ¤íƒì€ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ ìŠ¤íƒê³¼ ê°™ì€ ê²ƒìœ¼ë¡œ, ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ì˜ ìˆœì„œë¥¼ ê¸°ì–µí•˜ê³  ìˆë‹¤. í™ì—ëŠ” ê°ì²´ê°€ ì €ì¥ë˜ëŠ” ë©”ëª¨ë¦¬ ê³µê°„ìœ¼ë¡œ ë™ì ìœ¼ë¡œ ìƒê¸°ëŠ” ë³€ìˆ˜ë“¤, í¬ê¸°ë¥¼ ì •í•  ìˆ˜ ì—†ëŠ” ê°ì²´ë“¤ì„ ì €ì¥í•˜ê³  ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ëŠ” í™ì— ì €ì¥ëœ ê°ì²´ë“¤ì„ ì°¸ì¡°í•˜ê³  ìˆë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ì•ì„œ ë§í•œ ëŒ€ë¡œ ìë°”ìŠ¤í¬ë¦½íŠ¸ ìì²´ëŠ” ì‹±ê¸€ ìŠ¤ë ˆë“œë¡œ ì½œìŠ¤íƒì— ìŒ“ì—¬ìˆëŠ” ìˆœì„œë¡œ ì½”ë“œë¥¼ í‰ê°€í•˜ê³  ì‹¤í–‰í•˜ëŠ” ê¸°ëŠ¥ë§Œ ê°–ê³  ìˆë‹¤.

ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ìœ„í•´ì„œëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì´ ì‘ë™í•˜ëŠ” **Node Jsë‚˜ ë¸Œë¼ìš°ì €**ê°€ ë„ì™€ì¤˜ì•¼ í•œë‹¤. ì•ì„  ì½”ë“œì—ì„œ ì‚¬ìš©ëœ setTimeoutê³¼ ê°™ì€ ë¸Œë¼ìš°ì €/Node APIë¥¼ ì‚¬ìš©í•˜ë©´ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì€ í‰ê°€í•˜ê³  ì‹¤í–‰í•˜ëŠ”ë°, í˜¸ì¶œë˜ëŠ” ì‹œì ê³¼ ì½œë°±í•¨ìˆ˜ì˜ ë“±ë¡ì€ ë¸Œë¼ìš°ì €ì™€ Node.jsê°€ í•´ ì¤€ë‹¤. ì´ë ‡ê²Œ ë“±ë¡í•  ì½œë°±í•¨ìˆ˜ë¥¼ ë³´ê´€í•˜ëŠ” ê³³ì€ **Task Queue**ë‹¤. Task Queueì— ì €ì¥ëœ callbackí•¨ìˆ˜ëŠ” í•˜ë‚˜ì”© callstack ë¹„ì–´ ìˆì„ ë•Œ ê°€ì ¸ì™€ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì´ ì²˜ë¦¬í•  ìˆ˜ ìˆê²Œ í•œë‹¤.

ì´ë ‡ê²Œ ë‹¤ë¥¸ ì—­í• ì„ ê°–ê³  ìˆëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ê³¼ ë¸Œë¼ìš°ì €ë¥¼ ì—°ê²°í•´ ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ ë™ì‹œì„±ì„ ì§€ì›í•˜ëŠ” ê²ƒì´ **Event loop**ì´ë‹¤.

`ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„`: í•¨ìˆ˜ì˜ ìˆœì„œë¥¼ ê¸°ì–µí•˜ê³  ìˆëŠ” ì½œìŠ¤íƒê³¼ ë™ì ì¸ ë³€ìˆ˜ê°€ ì €ì¥ë˜ëŠ” í™ ë©”ëª¨ë¦¬ë¡œ êµ¬ì„±ëœ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì€ ìˆœì„œëŒ€ë¡œ ì½”ë“œë¥¼ í‰ê°€í•˜ê³  ì‹¤í–‰í•˜ëŠ” ê¸°ëŠ¥ë§Œ í•œë‹¤!!

`ë¸Œë¼ìš°ì € ë° node.js`ì˜ ì—­í• : APIë¥¼ ì œê³µí•˜ì—¬ ë¹„ë™ê¸° í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.

![https://miro.medium.com/max/875/1*iHhUyO4DliDwa6x_cO5E3A.gif](https://miro.medium.com/max/875/1*iHhUyO4DliDwa6x_cO5E3A.gif)

ì•ì„  ë¹„ë™ê¸° ì˜ˆì œë¥¼ ë‹¤ì‹œ ì„¤ëª…í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

```
const a = 1;
const b = 2;
const c = 3;

console.log(a);
setTimeout(() => {
 Â console.log(b);
}, 0);
console.log(c);
console.log(d);
console.log(f);

//ê²°ê³¼: a,c,d,f,b
```

1.  ì „ì—­ì»¨í…ìŠ¤íŠ¸ê°€ ë§Œë“¤ì–´ì§€ê³  ì½œìŠ¤íƒì— ë“¤ì–´ê°„ë‹¤.
2.  í‰ê°€ ê³¼ì •ì„ í†µí•´ ë³€ìˆ˜ a,b,cê°€ ë“±ë¡ë˜ê³  ì‹¤í–‰ ê³¼ì •ì—ì„œ WebAPIì¸ SetTimeOutì€ í•¨ìˆ˜ ì»¨í…ìŠ¤íŠ¸ë¥¼ ë§Œë“¤ì–´ ì½œìŠ¤íƒì— ì¶”ê°€ëœë‹¤.
3.  SetTimeOut ë‚´ë¶€ ì½œë°± í•¨ìˆ˜ëŠ” ë¸Œë¼ìš°ì €ë¡œ ë„˜ì–´ê°€ê³  í•¨ìˆ˜ ì»¨í…ìŠ¤íŠ¸ëŠ” ì¢…ë£Œë˜ì–´ ì½œìŠ¤íƒì—ì„œ ì œê±°ëœë‹¤.
4.  íƒ€ì´ë¨¸ê°€ ì™„ë£Œë˜ë©´ taskQueueì— ì½œë°± í•¨ìˆ˜ê°€ ë“±ë¡ë˜ëŠ”ë°, ì´ ê³¼ì •ì—ì„œ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì€ ë‹¤ìŒ ì‹¤í–‰ ì½”ë“œì¸ console.log(c)ê°€ ì²˜ë¦¬í•œë‹¤.
5.  call stackì´ ë‹¤ ë¹„ë©´ taskQueueì— ìˆë˜ ì½œë°± í•¨ìˆ˜ë¥¼ ê°€ì ¸ì™€ console.log(c)ë¥¼ ìˆ˜í–‰í•œë‹¤.

ì´ëŸ¬í•œ ê³¼ì • ë•Œë¬¸ì— ê²°ê³¼ê°€ 1,3,2ë¡œ ì²˜ë¦¬ë˜ì—ˆë˜ ê²ƒì´ë‹¤.

ì£¼ì˜í•  ì ì€ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì€ ì‹±ê¸€ ìŠ¤ë ˆë“œì´ì§€ë§Œ ë¸Œë¼ìš°ì €ëŠ” ë©€í‹°ìŠ¤ë ˆë“œë¡œ ì—¬ëŸ¬ê°€ì§€ ì¼ì„ ë™ì‹œì— ì²˜ë¦¬í•´ ì¤„ ìˆ˜ ìˆë‹¤.

ê·¸ëŸ¬ë©´ ëª¨ë“  ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ì½œë°±í•¨ìˆ˜ë¡œ í•˜ë©´ ë˜ëŠ”ê±¸ê¹Œ?

## ğŸ™ŒğŸ¼Â ì½œë°± í•¨ìˆ˜ë€

ì¸ìë¡œ ë˜ ë‹¤ë¥¸ í•¨ìˆ˜ë¥¼ ë„˜ê²¨ì£¼ëŠ” í•¨ìˆ˜ë¥¼ ì½œë°±ì´ë¼ê³  í•œë‹¤.

```jsx
const mom = (num1 , num2 , callback ) => {
	let sum = num1 + num2
	callback(sum)
}

const showSumNum = (num) => {
	console.log(num)
}

```

## **â— ì½œë°± í•¨ìˆ˜ì˜ í•œê³„**

ì½œë°±í•¨ìˆ˜ëŠ” **ì½œë°±í•¨ìˆ˜ ë‚´ë¶€ ê²°ê³¼ë¥¼ ì™¸ë¶€ë¡œ ë°˜í™˜í•  ìˆ˜ ì—†ë‹¤**. ì•ì„œ ì‚¬ìš©í•œ setTimeOutì„ ì˜ˆë¡œ ì„¤ëª…í•´ë³´ë©´ ì½œë°± í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ëŠ” ì‹œì ì—ëŠ” setTimeOutì˜ í•¨ìˆ˜ ì»¨í…ìŠ¤íŠ¸ê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ìƒìœ„ ìŠ¤ì½”í”„ì˜ ë³€ìˆ˜ì— ê°’ì„ í• ë‹¹í•˜ê±°ë‚˜ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ëŠ” ê²ƒì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— try-catchë¬¸ìœ¼ë¡œ ì—ëŸ¬ ì²˜ë¦¬ë¥¼ í•˜ë ¤í•´ë„ ì—ëŸ¬ê°€ ë°œìƒí•˜ëŠ” ì‹œì ì—ì„œì˜ ì—ëŸ¬ëŠ” ì¡íˆì§€ ì•ŠëŠ”ë‹¤.

```jsx

let g = 0;
setTimeout(() => {g = 100;} , 0)
console.log(g)  // 0ì¼ê¹Œ 100ì¼ê¹Œ? 

```

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-03-25 á„‹á…©á„’á…® 7.31.53.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1b27dba2-7a41-46e7-8197-d7497c6d9b62/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-03-25_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_7.31.53.png)

1.  ì „ì—­ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ ìƒì„± g = 0 , setTimeout í•¨ìˆ˜
2.  setTimeout í•¨ìˆ˜ ë‚´ì— ìˆëŠ” ì½œë°± í•¨ìˆ˜ (() â‡’ {g = 100;})ì´ task queueë¡œ ì´ë™ (ì „ì—­ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ê°€ ì¢…ë£Œë˜ë©´ ì½œë°±ì´ ì‹¤í–‰)
3.  ì¦‰ console.log(g) ì½”ë“œê°€ ì‹¤í–‰ë ë•ŒëŠ” 2ë²ˆì´ ì‹¤í–‰ë˜ì§€ ì•Šì€ ì‹œê¸°

ì‹¤í–‰ ê²°ê³¼ì— ë”°ë¼ ë‹¤ìŒ ê³¼ì •ì„ ì „ë‹¬í•˜ê¸° ìœ„í•´ì„œëŠ” ì½œë°± í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ì²˜ë¦¬ë˜ì–´ì•¼ í•˜ê³ , ì´ ê³¼ì •ì´ ì¤‘ì²©ë˜ê²Œ ë˜ë©´ì„œ ê°€ë…ì„±ì´ ë–¨ì–´ì§€ëŠ” "Callback hell"ì´ ëœë‹¤.

ì•„ë˜ ì½”ë“œëŠ” Callback hellì˜ ì˜ˆì œë¡œ ë¡œê·¸ì¸ ê³¼ì •ì„ êµ¬í˜„í•œ ì½”ë“œë‹¤. ì´ë ‡ê²Œ ì½”ë“œê°€ ì§œì—¬ì ¸ ìˆë‹¤ë©´ ê°€ë…ì„±ì´ ë–¨ì–´ì§€ê³ , ìœ ì§€ ë³´ìˆ˜ì—ë„ ì–´ë ¤ìš´ ë‹¨ì ì„ ê°–ëŠ”ë‹¤.

```
class UserStorage{
 Â  Â loginUser(id, password, onSuccess, onError){
 Â  Â  Â setTimeout(() =>{
 Â  Â  Â  Â if(
 Â  Â  Â  Â  Â   (id === 'seul' && password === '123') ||
 Â  Â  Â  Â  Â   (id === 'kim' && password === '456')
 Â  Â  Â  Â  ) {
 Â  Â  Â  Â  Â  Â onSuccess(id);
 Â  Â  Â  Â  } else{
 Â  Â  Â  Â  Â  Â onError(new Error('error'));
 Â  Â  Â  Â  }
 Â  Â  Â   }, 2000);
 Â   }

 Â  Â getRoles(user, onSuccess, onError){
 Â  Â  Â  Â setTimeout(()=> {
 Â  Â  Â  Â  Â  Â if (user === 'seul') {
 Â  Â  Â  Â  Â  Â  Â  Â onSuccess({name: 'seul', role: 'admin'});
 Â  Â  Â  Â  Â   } else {
 Â  Â  Â  Â  Â  Â  Â  Â onError(new Error('error'));
 Â  Â  Â  Â  Â   }
 Â  Â  Â   }, 1000);
 Â   }
};

const userStorage = new UserStorage();
const id = prompt('ì•„ì´ë””ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”!');
const password = prompt('ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”!!');

userStorage.loginUser(
 Â  Â id,
 Â  Â password,
 Â  Â user => {
 Â  Â  Â  Â userStorage.getRoles(
 Â  Â  Â  Â  Â  Â user,
 Â  Â  Â  Â  Â  Â userWithRole => {
 Â  Â  Â  Â  Â  Â  Â  Â alert(`hello ${userWithRole.name}, you have a ${userWithRole.role} role`)
 Â  Â  Â  Â  Â   },
 Â  Â  Â  Â  Â  Â error => {
 Â  Â  Â  Â  Â  Â  Â  Â console.log('ì—ëŸ¬2')
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â   );
 Â  Â  Â   },
 Â  Â error => {console.log('ì—ëŸ¬1')}
);
```

ê·¸ëŸ¬ë©´ callbackí•¨ìˆ˜ì˜ í•œê³„ë¥¼ ì–´ë–»ê²Œ ê·¹ë³µí•  ìˆ˜ ìˆì„ê¹Œ?

## **ğŸˆ callback í•¨ìˆ˜ì˜ í•œê³„ë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•œ, Promise**

PromiseëŠ” ë§ ê·¸ëŒ€ë¡œ ì•½ì†, ì´í›„ì— ì•½ì†ëœ ê²°ê³¼ë¥¼ ì£¼ê² ë‹¤ëŠ” ì˜ë¯¸ë¥¼ ê°€ì§€ë©°, ë¹„ë™ê¸° ì²˜ë¦¬ ìƒíƒœì™€ ê²°ê³¼ë¥¼ ê´€ë¦¬í•˜ëŠ” ê°ì²´ë‹¤.

promiseì˜ ë¹„ë™ê¸° ì²˜ë¦¬ ìƒíƒœëŠ” pending (ìˆ˜í–‰ë˜ì§€ ì•Šì€ ìƒíƒœ), fulfilled (ì„±ê³µ), rejected (ì‹¤íŒ¨), ì„¸ ê°€ì§€ê°€ ìˆê³ , ìƒíƒœ ì •ë³´ëŠ” promiseë¥¼ ë§Œë“¤ ë•Œ ì „ë‹¬ ë°›ì€ ì¸ìì¸ resolveì™€ rejectë¥¼ í˜¸ì¶œí•˜ë©´ì„œ ë³€ê²½ëœë‹¤. resolveëŠ” ì„±ê³µ ì‹œì— ìˆ˜í–‰í•  í•¨ìˆ˜, rejectëŠ” ì‹¤íŒ¨ ì‹œì— ìˆ˜í–‰í•  í•¨ìˆ˜ì´ë‹¤.

ë¹„ë™ê¸° ì²˜ë¦¬ ê²°ê³¼ì— ë”°ë¼ ë‹¤ìŒ í›„ì† ì²˜ë¦¬ë¥¼ ìœ„í•´ì„œ then, catch, finally ë‚´ì¥ ë©”ì†Œë“œë¥¼ ì´ìš©í•  ìˆ˜ ìˆìœ¼ë©°, thenì€ ì„±ê³µí–ˆì„ ë•Œë¥¼, catchëŠ” ì‹¤íŒ¨í–ˆì„ ë•Œ, finallyëŠ” ì„±ê³µ,ì‹¤íŒ¨ì™€ ìƒê´€ì—†ì´ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤. ê°ê°ì€ promiseë¥¼ ë°˜í™˜í•˜ê¸° ë•Œë¬¸ì— ì²´ì´ë‹ì´ ê°€ëŠ¥í•˜ë‹¤.

ì²´ì´ë‹ì—ì„œ ì£¼ì˜í•  ì ì€ ì„±ê³µ ì‹œ ë°˜í™˜í•œ ê°’ì€ ë‹¤ìŒ thenì˜ ì¸ìë¡œ ì „ë‹¬ ë˜ê³ , promiseë¡œ ê³„ì†í•´ì„œ ì²˜ë¦¬ê°€ ëœë‹¤ëŠ” ì ì´ë‹¤. promiseë¥¼ ì²˜ìŒ ë°°ìš¸ ë•Œ ê°€ì¥ ì–´ë ¤ìš´ ë¶€ë¶„ì´ì—ˆë‹¤. catchëŠ” ì–´ëŠ ê³³ì—ì„œ ì—ëŸ¬ê°€ ë‚˜ë„ ë°›ì•„ì˜¤ê¸° ë•Œë¬¸ì— thenì˜ ë‘ ë²ˆì§¸ ì¸ìë¡œ ì—ëŸ¬ì²˜ë¦¬ë¥¼ í•˜ì§€ë§ê³ , í•­ìƒ catchë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ íš¨ìœ¨ì ì´ë‹¤.

```
function getData(state) {
 Â return new Promise(function (resolve, reject) {
 Â  Â if (state === 'ì„±ê³µ') {
 Â  Â  Â resolve('ì„±ê³µ');
 Â   } else {
 Â  Â  Â reject(new Error('Request is failed'));
 Â   }
  });
}

getData("ì„±ê³µ")
  .then(console.log) //ì„±ê³µ
  .catch(function (err) {
 Â  Â console.log(err);
  });

getData("ì‹¤íŒ¨")
  .then(console.log)
  .catch(function (err) {
 Â  Â console.log(err); // Error: Request is failed
  });

```

ê·¸ëŸ¬ë©´ ì´ë²ˆì—” ì•ì„œ ë³´ì•˜ë˜ callback hell ì˜ˆì œë¥¼ promiseë¡œ í•´ê²°í•´ë³´ì

```

class UserStorage{
 Â  Â loginUser(id, password){
 Â  Â  Â  Â return new Promise((resolve, reject) => {
 Â  Â  Â  Â  Â  setTimeout(() =>{
 Â  Â  Â  Â  Â  Â  Â  if(
 Â  Â  Â  Â  Â  Â  Â  Â  Â  (id === 'seul' && password === '123') ||
 Â  Â  Â  Â  Â  Â  Â  Â  Â  (id === 'kim' && password === '456')
 Â  Â  Â  Â  Â  Â  Â  Â  ) {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â resolve(id);
 Â  Â  Â  Â  Â  Â  Â  Â  } else{
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â reject(new Error('ì—ëŸ¬1'));
 Â  Â  Â  Â  Â  Â  Â  Â  }
 Â  Â  Â  Â  Â  }, 2000);
 Â  Â  Â  })
 Â   }

 Â  Â getRoles(user){
 Â  Â  Â  return new Promise((resolve, reject) => {
 Â  Â  Â  Â  Â setTimeout(()=> {
 Â  Â  Â  Â  Â  Â  Â if (user === 'seul') {
 Â  Â  Â  Â  Â  Â  Â  Â resolve({name: 'seul', role: 'admin'});
 Â  Â  Â  Â  Â  Â   } else {
 Â  Â  Â  Â  Â  Â  Â  Â reject(new Error('ì—ëŸ¬2'));
 Â  Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  }, 1000);
 Â  Â  Â  })
 Â   }
};

const userStorage = new UserStorage();
const id = prompt('ì•„ì´ë””ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”!');
const password = prompt('ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”!!');

userStorage.loginUser(id, password)
.then(userStorage.getRoles)
.then(user => alert(`hello ${user.name}, you have a ${user.role} role`))
.catch(console.log);
```

í´ë˜ìŠ¤ ë‚´ë¶€ëŠ” í¬ê²Œ ë‹¬ë¼ì§„ ê²ƒì€ ì—†ì§€ë§Œ ì‚¬ìš©í•  ë•Œ ë³µì¡ë„ê°€ í¬ê²Œ ì¤„ì–´ ê°€ë…ì„±ì´ í–¥ìƒëœ ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ì´ë ‡ê²Œ í”„ë¡œë¯¸ìŠ¤ë¥¼ í†µí•´ callbackí•¨ìˆ˜ì˜ í•œê³„ì¸ í›„ì†ì²˜ë¦¬ì™€ ì—ëŸ¬ì²˜ë¦¬ë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆì—ˆë‹¤.

### **Promiseì˜ ë©”ì†Œë“œ**

promiseì˜ ë˜ë‹¤ë¥¸ ì¥ì ì€ promise ìì²´ì ìœ¼ë¡œ ì œê³µí•˜ëŠ” ë‹¤ì–‘í•œ ë©”ì†Œë“œë‹¤.

### **1. Promise.all**

ì—¬ëŸ¬ê°œì˜ promiseë¥¼ ë™ì‹œì— ë³‘ë ¬ì ìœ¼ë¡œ ì´ìš©í•  ë•Œ, ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë©”ì†Œë“œë¡œ, ì¸ìë¡œ í”„ë¡œë¯¸ìŠ¤ì˜ ì´í„°ëŸ¬ë¸”ì„ ì „ë‹¬ë°›ëŠ”ë‹¤. ì „ë‹¬ëœ ì´í„°ëŸ¬ë¸”ì˜ ìˆœì„œê°€ ë³´ì¥ë˜ì–´ ë°˜í™˜ë˜ë©°, ìš”ì†Œì¤‘ í•˜ë‚˜ë¼ë„ rejectedìƒíƒœê°€ ë˜ë©´ ë°”ë¡œ ì¢…ë£Œë˜ë©° ê°€ì¥ ë¨¼ì € rejectedëœ ê²°ê³¼ë¥¼ catchë¡œ ì „ë‹¬í•œë‹¤.

ì•„ë˜ì˜ ì˜ˆì œì—ëŠ” ì„¸ê°€ì§€ ì„œë¡œ ì˜ì¡´ë˜ì§€ ì•ŠëŠ” promiseê°€ ìˆ˜í–‰ë˜ëŠ”ë°. chainingì„ ì´ìš©í•´ ì´ 6ì´ˆ ì •ë„ê°€ ê±¸ë¦¬ëŠ” ìƒí™©ì´ë‹¤.

```
const requestData1 = () =>
 Â new Promise((resolve) => setTimeout(() => resolve(1), 3000));
const requestData2 = () =>
 Â new Promise((resolve) => setTimeout(() => resolve(2), 2000));
const requestData3 = () =>
 Â new Promise((resolve) => setTimeout(() => resolve(3), 1000));

const res = [];
requestData1()
  .then((data) => { //3ì´ˆë’¤ ë°›ì•„ì™€
 Â  Â res.push(data);
 Â  Â return requestData2();
  })
  .then((data) => { //2ì´ˆë’¤ ë°›ì•„ì™€
 Â  Â res.push(data);
 Â  Â return requestData3();
  })
  .then((data) => { //1ì´ˆë’¤ ë°›ì•„ì™€
 Â  Â res.push(data);
 Â  Â console.log(data); //ì´ 6ì´ˆ ë’¤ í˜¸ì¶œ
  })
  .catch(console.log);

```

promise.allì„ ì´ìš©í•˜ë©´ ê°€ì¥ ì˜¤ë˜ ê±¸ë¦¬ëŠ” requestData1ì´ fulfilled ìƒíƒœê°€ ë  ë•Œ, ì´ 3ì´ˆ ì •ë„ê°€ ì§€ë‚˜ê³  thenìœ¼ë¡œ ì²˜ë¦¬ ê²°ê³¼ë¥¼ ì „ë‹¬ë˜ì–´ ë” íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬ê°€ ê°€ëŠ¥í•˜ë‹¤.

```
const requestData1 = () =>
 Â new Promise((resolve) => setTimeout(() => resolve(1), 3000));
const requestData2 = () =>
 Â new Promise((resolve) => setTimeout(() => resolve(2), 2000));
const requestData3 = () =>
 Â new Promise((resolve) => setTimeout(() => resolve(3), 1000));

Promise.all([requestData1(), requestData2(), requestData3()])
  .then(console.log) //[1,2,3]
  .catch(console.error);
```

### **2. Promise.race**

Promise.raceëŠ” ë§ ê·¸ëŒ€ë¡œ ê²½ì£¼í•˜ë“¯ì´, ì „ë‹¬ ë°›ì€ promise ì¤‘ ê°€ì¥ ë¨¼ì € fulfilledëœ promiseì˜ ì²˜ë¦¬ê²°ê³¼ë¥¼ resolveí•˜ëŠ” promiseë¥¼ ë°˜í™˜í•œë‹¤. ì—ëŸ¬ ì²˜ë¦¬ëŠ” Promise.allê³¼ ë™ì¼í•˜ê²Œ ìš”ì†Œ ì¤‘ í•˜ë‚˜ë¼ë„ rejectedìƒíƒœê°€ ë˜ë©´ ë°”ë¡œ ì¢…ë£Œë˜ë©° ê°€ì¥ ë¨¼ì € rejectedëœ ê²°ê³¼ë¥¼ catchë¡œ ì „ë‹¬í•œë‹¤.

```
const requestData1 = () =>
 Â new Promise((resolve) => setTimeout(() => resolve(1), 3000));
const requestData2 = () =>
 Â new Promise((resolve) => setTimeout(() => resolve(2), 2000));
const requestData3 = () =>
 Â new Promise((resolve) => setTimeout(() => resolve(3), 1000));

Promise.race([requestData1(), requestData2(), requestData3()])
  .then(console.log) //3
  .catch(console.error);
```

### **3. Promise.allSettled**

settledì€ fulfilledì´ë‚˜ rejectedë¡œ ë¹„ë™ê¸° ì²˜ë¦¬ê°€ ëœ ìƒíƒœë¥¼ ì˜ë¯¸í•´ ì„±ê³µ/ì‹¤íŒ¨ ì—¬ë¶€ì™€ ìƒê´€ì—†ì´ ê²°ê³¼ë¥¼ ë°˜í™˜í•´ ì£¼ëŠ” ë©”ì†Œë“œë‹¤.

```

Promise.allSettled([
 Â new Promise((resolve) =>
 Â  Â setTimeout(() => {
 Â  Â  Â resolve(1);
 Â   }, 2000)
  ),
 Â new Promise((_, reject) =>
 Â  Â setTimeout(() => {
 Â  Â  Â reject(new Error('error'));
 Â   }, 1000)
  ),
]).then(console.log);

//ê²°ê³¼:
[
  { status: 'fulfilled', value: 1 },
  {
 Â  Â status: 'rejected',
 Â  Â reason: Error: error
 Â  Â  Â  Â at Timeout._onTimeout (C:\\Users\\juni2\\projects\\js study\\DeepDive\\main.js:32:14)
 Â  Â  Â  Â at listOnTimeout (node:internal/timers:559:17)
 Â  Â  Â  Â at processTimers (node:internal/timers:502:7)
  }
]

```

## **Promise ì²˜ë¦¬ëŠ” microtask Queue**

event loopì„ ì„¤ëª…í•˜ë©´ì„œ callbackì€ task queueì— ì €ì¥ëœë‹¤. promiseëŠ” callbackí•¨ìˆ˜ì™€ ë‹¬ë¦¬ task Queueê°€ ì•„ë‹Œ micro-task Queueì— ì €ì¥ëœë‹¤.

![https://res.cloudinary.com/practicaldev/image/fetch/s--05Fi8vBq--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/42eatw03fcha0e1qcrf0.gif](https://res.cloudinary.com/practicaldev/image/fetch/s--05Fi8vBq--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/42eatw03fcha0e1qcrf0.gif)

microtask queueëŠ” task queueë³´ë‹¤ ìš°ì„ ìˆœìœ„ê°€ ë†’ì•„ callstackì´ ë¹„ê²Œ ë˜ë©´, event loopì´ microtask queueì˜ promiseë¥¼ **ë‹¤ ê°€ì ¸ì™€** ì²˜ë¦¬í•œë‹¤. ì´ë•Œ microtask Queueê°€ ë¹„ì§€ ì•Šìœ¼ë©´ ë‹¤ìŒìœ¼ë¡œ event loopì´ ì´ë™í•˜ì§€ ì•Šê³  ê³„ì†í•´ì„œ ë¨¸ë¬¼ëŸ¬ì„œ ë¸Œë¼ìš°ì €ê°€ ì£½ì–´ë²„ë¦¬ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

```

function handleClick() {
 Â Promise.resolve(0).then(() => {
 Â  Â handleClick(); //ì¬ê·€ë¡œ ê³„ì†í•´ì„œ promiseë¥¼ ì¶”ê°€í•´
  });
}

handleClick();
```

[ì°¸ì¡°]

[**Understanding Event Loop, Call Stack, Event & Job Queue in Javascript**] Â [https://medium.com/@Rahulx1/understanding-event-loop-call-stack-event-job-queue-in-javascript-63dcd2c71ecd](https://medium.com/@Rahulx1/understanding-event-loop-call-stack-event-job-queue-in-javascript-63dcd2c71ecd)

[**ëª¨ë˜ ìë°”ìŠ¤í¬ë¦½íŠ¸ ë”¥ë‹¤ì´ë¸Œ** ] Â [http://www.yes24.com/Product/Goods/92742567](http://www.yes24.com/Product/Goods/92742567)

[**Callback Hell (ì½œë°± ì§€ì˜¥)**] Â [https://velog.io/@seul06/JavaScript-ì½œë°±-ì§€ì˜¥](https://velog.io/@seul06/JavaScript-%EC%BD%9C%EB%B0%B1-%EC%A7%80%EC%98%A5)

[**ìë°”ìŠ¤í¬ë¦½íŠ¸ Promise ì‰½ê²Œ ì´í•´í•˜ê¸°**] Â [https://joshua1988.github.io/web-development/javascript/promise-for-beginners/#promiseê°€-ë­”ê°€ìš”](https://joshua1988.github.io/web-development/javascript/promise-for-beginners/#promise%EA%B0%80-%EB%AD%94%EA%B0%80%EC%9A%94)